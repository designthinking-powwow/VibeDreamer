
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibe Dreamer - æ•™å­¸å·¥å…·ç¶²é </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;900&family=Noto+Sans+TC:wght@400;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', 'Noto Sans TC', sans-serif; background-color: #f8fafc; margin: 0; padding: 0; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .floating { animation: float 3s ease-in-out infinite; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c7d2fe; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #818cf8; }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom": "https://esm.sh/react-dom@^19.2.3",
    "react-dom/client": "https://esm.sh/react-dom@^19.2.3/client",
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useCallback } from 'react';
        import ReactDOM from 'react-dom/client';
        import { GoogleGenAI } from "@google/genai";

        // --- è¨­å®šå¸¸æ•¸ ---
        const ROLES_MAP = {
            'å…¨ç«¯å·¥ç¨‹å¸«': { label: 'è¬èƒ½é–‹ç™¼è€…', emoji: 'ğŸ§™â€â™‚ï¸' },
            'UIè¨­è¨ˆå¸«': { label: 'ç¾æ„Ÿè¦–è¦ºå¤§å¸«', emoji: 'ğŸ¨' },
            'å‰ç«¯é–‹ç™¼è€…': { label: 'äº’å‹•é­”æ³•å¸«', emoji: 'âœ¨' },
            'å¾Œç«¯å°ˆå®¶': { label: 'æ•¸æ“šå®ˆè­·è€…', emoji: 'ğŸ§ ' },
            'Pythonå°ˆå®¶': { label: 'è‡ªå‹•åŒ–å°ˆå®¶', emoji: 'ğŸ' },
            'ç”¢å“ç¶“ç†': { label: 'å‰µæ„å°èˆªå“¡', emoji: 'ğŸ—ºï¸' }
        };

        const STYLES = ['æ¥µç°¡', 'æ·±è‰²', 'å¯æ„›é¢¨', 'è³½åšé¾å…‹', 'å•†å‹™å°ˆæ¥­', 'å¾©å¤é¢¨'];
        const PLATFORMS = ['Web ç¶²é ', 'Mobile App', 'Android', 'iOS', 'Desktop æ¡Œé¢ç¨‹å¼'];
        const COMMON_FEATURES = [
            { id: 'auth', label: 'å¸³è™Ÿç™»å…¥åŠŸèƒ½', emoji: 'ğŸ”‘' },
            { id: 'responsive', label: 'éŸ¿æ‡‰å¼è¨­è¨ˆ (æ‰‹æ©Ÿå¯ç”¨)', emoji: 'ğŸ“±' },
            { id: 'darkmode', label: 'é»‘å¤œæ¨¡å¼', emoji: 'ğŸŒ™' },
            { id: 'db', label: 'è³‡æ–™åº«å„²å­˜', emoji: 'ğŸ’¾' }
        ];

        // --- è¼”åŠ©çµ„ä»¶ ---
        const Tooltip = ({ text }) => {
            const [show, setShow] = useState(false);
            return (
                <div className="relative inline-block ml-2">
                    <div onMouseEnter={() => setShow(true)} onMouseLeave={() => setShow(false)} className="cursor-help inline-flex items-center justify-center w-5 h-5 rounded-full bg-slate-200 text-slate-500 text-[10px] font-bold">?</div>
                    {show && <div className="absolute z-50 w-48 px-3 py-2 mt-2 text-xs font-medium text-white bg-slate-800 rounded-xl shadow-xl">{text}</div>}
                </div>
            );
        };

        const App = () => {
            const [showSettings, setShowSettings] = useState(false);
            const [customApiKey, setCustomApiKey] = useState(() => localStorage.getItem('vibe_dreamer_api_key') || '');
            const [progress, setProgress] = useState(0);
            const [form, setForm] = useState({ roles: ['å…¨ç«¯å·¥ç¨‹å¸«'], task: '', platform: 'Web ç¶²é ', style: 'æ¥µç°¡', features: '', selectedCommonFeatures: [], language: 'ç¹é«”ä¸­æ–‡' });
            const [analyzeUrl, setAnalyzeUrl] = useState('');
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            const [analysisError, setAnalysisError] = useState(null);
            const [generatedPrompt, setGeneratedPrompt] = useState('');
            const [copySuccess, setCopySuccess] = useState(false);

            // é€²åº¦æ¢é‚è¼¯
            useEffect(() => {
                let p = 0;
                if (form.task) p += 30;
                if (form.roles.length > 0) p += 20;
                if (form.selectedCommonFeatures.length > 0) p += 20;
                if (form.features) p += 30;
                setProgress(p);
            }, [form]);

            // æç¤ºè©ç”Ÿæˆé‚è¼¯
            useEffect(() => {
                const roleString = form.roles.map(r => ROLES_MAP[r]?.label || r).join(' èˆ‡ ');
                const features = [...form.selectedCommonFeatures.map(id => COMMON_FEATURES.find(f => f.id === id)?.label), form.features].filter(Boolean).join('ã€');
                setGeneratedPrompt(`ä½ ç¾åœ¨æ˜¯æˆ‘çš„å°ˆå±¬ ${roleString}ã€‚æˆ‘çš„é»å­æ˜¯ã€Œ${form.task || 'å‰µæ„å°ˆæ¡ˆ'}ã€ã€‚\né–‹ç™¼å¹³å°ï¼š${form.platform}\nè¨­è¨ˆé¢¨æ ¼ï¼š${form.style}\nåŠŸèƒ½éœ€æ±‚ï¼š${features || 'åŸºæœ¬åŠŸèƒ½'}\nè«‹ç”¨å–®ä¸€ index.html æª”æ¡ˆå¯¦ä½œï¼Œä½¿ç”¨ Tailwind CSSï¼Œä¸¦ç”¨${form.language}å›è¦†ã€‚`);
            }, [form]);

            const handleAIAnalysis = async () => {
                if (!customApiKey) { setShowSettings(true); return; }
                setIsAnalyzing(true); setAnalysisError(null);
                try {
                    const ai = new GoogleGenAI({ apiKey: customApiKey });
                    const response = await ai.models.generateContent({
                        model: 'gemini-3-flash-preview',
                        contents: `è«‹åˆ†ææ­¤ç¶²é ä¸¦è½‰åŒ–ç‚ºé–‹ç™¼å»ºè­° JSONï¼š${analyzeUrl}`,
                        config: { tools: [{ googleSearch: {} }] }
                    });
                    const json = JSON.parse(response.text.match(/\{[\s\S]*\}/)[0]);
                    setForm(prev => ({ ...prev, task: json.task || '', style: 'æ¥µç°¡', features: json.features || '' }));
                } catch (e) { setAnalysisError("åˆ†æå¤±æ•—ï¼Œè«‹æª¢æŸ¥é‡‘é‘°æˆ–ç¶²å€ã€‚"); }
                finally { setIsAnalyzing(false); }
            };

            return (
                <div className="min-h-screen pb-20">
                    <div className="fixed top-0 left-0 w-full h-2 bg-slate-200 z-[100]">
                        <div className="h-full bg-indigo-600 transition-all duration-700" style={{ width: `${progress}%` }}></div>
                    </div>

                    {/* è¨­å®šæŒ‰éˆ• */}
                    <button onClick={() => setShowSettings(true)} className="fixed top-6 right-6 z-[90] p-4 bg-white rounded-full shadow-lg border border-slate-100">âš™ï¸</button>

                    {/* è¨­å®š Modal */}
                    {showSettings && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center p-4">
                            <div className="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onClick={() => setShowSettings(false)}></div>
                            <div className="relative bg-white rounded-[2.5rem] shadow-2xl w-full max-w-md p-10">
                                <h3 className="text-2xl font-black mb-6 text-indigo-600">API Key è¨­å®š</h3>
                                <input type="password" value={customApiKey} onChange={(e) => setCustomApiKey(e.target.value)} placeholder="åœ¨æ­¤è²¼ä¸Šé‡‘é‘°..." className="w-full rounded-2xl bg-slate-50 p-5 mb-4 outline-none border-2 border-transparent focus:border-indigo-400 font-mono" />
                                <button onClick={() => window.open('https://aistudio.google.com/app/apikey', '_blank')} className="w-full py-4 rounded-2xl border-2 border-indigo-100 text-indigo-600 font-bold mb-6 hover:bg-indigo-50 transition-all">ğŸš€ é»æˆ‘ç”³è«‹å…è²» API Key</button>
                                <button onClick={() => { localStorage.setItem('vibe_dreamer_api_key', customApiKey); setShowSettings(false); }} className="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black shadow-lg">ç¢ºèªä¸¦å„²å­˜</button>
                            </div>
                        </div>
                    )}

                    <div className="max-w-4xl mx-auto pt-20 px-6">
                        <header className="text-center mb-16">
                            <h1 className="text-5xl font-black text-slate-900 mb-4">Vibe <span className="text-indigo-600">Dreamer</span></h1>
                            <p className="text-slate-500 font-medium text-lg">è®“ AI å¹«ä½ å¯«ç¨‹å¼ï¼Œå¾ä¸€å€‹æ„Ÿè¦ºé–‹å§‹ã€‚</p>
                        </header>

                        {/* AI ç¶²é è§£æå€ */}
                        <div className="bg-white rounded-[3rem] p-10 shadow-2xl mb-12 border border-indigo-50">
                            <h3 className="text-xl font-black text-slate-800 mb-6 text-center">ğŸª„ AI é­”æ³•è§£æï¼šè²¼ä¸Šä½ å–œæ­¡çš„ç¶²é </h3>
                            <div className="flex flex-col sm:flex-row gap-4">
                                <input type="text" placeholder="https://..." className="flex-1 px-6 py-4 rounded-2xl bg-slate-50 border-2 border-transparent focus:border-indigo-300 outline-none" value={analyzeUrl} onChange={(e) => setAnalyzeUrl(e.target.value)} />
                                <button onClick={handleAIAnalysis} disabled={isAnalyzing} className="px-10 py-4 bg-indigo-600 text-white font-black rounded-2xl shadow-xl hover:bg-indigo-700 disabled:opacity-50">{isAnalyzing ? "æ­£åœ¨è§£æ..." : "å•Ÿå‹•é­”æ³•"}</button>
                            </div>
                            {analysisError && <p className="text-center mt-4 text-pink-500 text-sm font-bold">{analysisError}</p>}
                        </div>

                        {/* ä¸»è¡¨å–® */}
                        <div className="space-y-10">
                            <section className="bg-white rounded-[3rem] p-10 shadow-sm border border-slate-100">
                                <h2 className="text-2xl font-black text-slate-800 mb-8 flex items-center">
                                    <span className="w-10 h-10 rounded-xl bg-indigo-600 text-white flex items-center justify-center mr-4 shadow-lg text-sm">1</span>
                                    å®šç¾©éˆé­‚
                                </h2>
                                <div className="space-y-8">
                                    <div>
                                        <label className="text-xs font-black text-slate-400 uppercase tracking-widest mb-3 block">é»å­çš„åå­—</label>
                                        <input type="text" value={form.task} onChange={(e) => setForm({...form, task: e.target.value})} placeholder="ä¾‹å¦‚ï¼šæ¥µç°¡ç¦ªæ„æ™‚é˜" className="w-full rounded-2xl bg-slate-50 py-5 px-7 border-2 border-transparent focus:border-indigo-400 outline-none font-bold text-lg" />
                                    </div>
                                    <div>
                                        <label className="text-xs font-black text-slate-400 uppercase tracking-widest mb-3 block">å¯¦ç¾çš„è§’è‰²</label>
                                        <div className="grid grid-cols-2 sm:grid-cols-3 gap-3">
                                            {Object.entries(ROLES_MAP).map(([key, data]) => (
                                                <button key={key} onClick={() => setForm({...form, roles: [key]})} className={`p-4 rounded-3xl border-2 transition-all text-left flex flex-col gap-2 ${form.roles.includes(key) ? 'bg-indigo-600 border-indigo-600 text-white shadow-lg' : 'bg-white border-slate-100 text-slate-400 hover:border-indigo-200'}`}>
                                                    <span className="text-2xl">{data.emoji}</span>
                                                    <span className="text-xs font-black">{data.label}</span>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section className="bg-[#111] rounded-[3.5rem] shadow-2xl p-10">
                                <div className="bg-white/5 rounded-3xl p-6 border border-white/10 min-h-[200px] font-mono text-indigo-200/80 text-xs leading-relaxed whitespace-pre-wrap mb-8">
                                    {generatedPrompt}
                                </div>
                                <button onClick={async () => { await navigator.clipboard.writeText(generatedPrompt); setCopySuccess(true); setTimeout(()=>setCopySuccess(false),2000); }} className={`w-full py-6 rounded-3xl font-black text-xl transition-all ${copySuccess ? 'bg-emerald-500' : 'bg-indigo-600'} text-white shadow-xl shadow-indigo-900/20`}>
                                    {copySuccess ? "âœ… è¤‡è£½æˆåŠŸ" : "è¤‡è£½ AI æŒ‡ä»¤"}
                                </button>
                            </section>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
